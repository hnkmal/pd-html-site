<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡³é«˜ã®ã‚¹ã‚¤ãƒ¼ãƒ„ãƒšã‚¢ãƒªãƒ³ã‚°è¨ºæ–­</title>
    <style>
        :root {
            --bg-color: #fdfbf7;
            --primary-color: #8d6e63;
            --accent-color: #ffccbc;
            --text-color: #4e342e;
            --card-bg: #ffffff;
            --star-color: #f57c00;
            --star-bg: #e0e0e0;
            --surprise-color: #ef5350;
        }

        body {
            font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background-color: var(--card-bg);
            width: 100%;
            max-width: 500px;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            text-align: center;
        }

        h1 { font-size: 24px; color: var(--primary-color); margin-bottom: 20px; }
        .hidden { display: none; }

        /* è³ªå•ç”»é¢ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .progress-bar { width: 100%; height: 6px; background-color: #eee; border-radius: 3px; margin-bottom: 30px; overflow: hidden; }
        .progress-fill { height: 100%; background-color: var(--primary-color); width: 0%; transition: width 0.3s; }
        .question-text { font-size: 18px; margin-bottom: 25px; font-weight: bold; line-height: 1.5; }
        .options { display: flex; flex-direction: column; gap: 12px; }
        
        button {
            background-color: var(--bg-color);
            border: 2px solid var(--primary-color);
            padding: 14px;
            border-radius: 50px;
            font-size: 16px;
            cursor: pointer;
            transition: 0.2s;
            outline: none;
        }
        button:hover { background-color: var(--primary-color); color: white; }
        .start-btn { background-color: var(--primary-color); color: white; font-weight: bold; padding: 18px 40px; }

        /* çµæœç”»é¢ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .pairing-result { font-size: 26px; font-weight: bold; color: var(--primary-color); margin: 15px 0; padding: 20px; border: 2px dashed var(--accent-color); border-radius: 12px; background-color: #fffaf0; }
        .score-area { margin-bottom: 20px; display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .star-rating { position: relative; display: inline-block; font-size: 32px; line-height: 1; }
        .star-rating-front { position: absolute; top: 0; left: 0; overflow: hidden; width: 0%; color: var(--star-color); white-space: nowrap; }
        .star-rating-back { color: var(--star-bg); }
        .comment-box { text-align: left; background-color: #f5f5f5; padding: 15px; border-radius: 10px; font-size: 14px; line-height: 1.6; }

        /* æ„å¤–æ€§ã‚¨ãƒªã‚¢ */
        .surprise-section { margin-top: 25px; padding-top: 20px; border-top: 2px dotted #ddd; text-align: left; }
        .surprise-badge { background-color: var(--surprise-color); color: white; padding: 3px 10px; border-radius: 4px; font-size: 12px; font-weight: bold; display: inline-block; margin-bottom: 8px; }
        .surprise-title { font-weight: bold; font-size: 18px; color: var(--surprise-color); margin-bottom: 5px; }
        .surprise-text { font-size: 13px; color: #666; }

        .fade-in { animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <div id="start-screen">
        <h1>ã‚¹ã‚¤ãƒ¼ãƒ„ãƒšã‚¢ãƒªãƒ³ã‚°è¨ºæ–­</h1>
        <p>10ã¤ã®è³ªå•ã‹ã‚‰ã€ã‚ãªãŸã®å¥½ã¿ã«åˆã£ãŸ<br>ã€Œç‹é“ã€ã¨ã€Œæ„å¤–ã€ãªçµ„ã¿åˆã‚ã›ã‚’ç®—å‡ºã—ã¾ã™ã€‚</p>
        <div style="font-size: 50px; margin: 30px 0;">ğŸ°â˜•ï¸âœ¨</div>
        <button class="start-btn" onclick="startQuiz()">è¨ºæ–­ã‚’ã¯ã˜ã‚ã‚‹</button>
    </div>

    <div id="quiz-screen" class="hidden">
        <div class="progress-bar"><div class="progress-fill" id="progress"></div></div>
        <div id="question-container" class="fade-in">
            <div class="question-text" id="question-text"></div>
            <div class="options" id="options-container"></div>
        </div>
    </div>

    <div id="result-screen" class="hidden fade-in">
        <div style="font-size: 14px; color: #888;">ã‚ãªãŸã«æœ€ã‚‚èª¿å’Œã™ã‚‹ä¸€æ¯ã¯â€¦</div>
        <div class="pairing-result" id="result-drink"></div>
        
        <div class="score-area">
            <div id="score-text" style="font-weight: bold; color: var(--star-color); font-size: 18px;"></div>
            <div class="star-rating">
                <div class="star-rating-back">â˜…â˜…â˜…â˜…</div>
                <div class="star-rating-front" id="star-fill">â˜…â˜…â˜…â˜…</div>
            </div>
        </div>
        
        <div class="comment-box">
            <p id="result-science-comment"></p>
        </div>

        <div id="surprise-area" class="surprise-section hidden">
            <div class="surprise-badge">æ„å¤–ãªç™ºè¦‹ï¼</div>
            <div id="surprise-drink" class="surprise-title"></div>
            <div id="surprise-comment" class="surprise-text"></div>
        </div>

        <button class="start-btn" style="margin-top: 30px; width: 100%;" onclick="location.reload()">ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹</button>
    </div>
</div>

<script>
    /* --- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ --- */
    const pairingsDB = {
        "donut": [
            { id: "milk", name: "ç‰›ä¹³", score: 4.00, comment: "å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã§æº€ç‚¹ã®4.0ã‚’è¨˜éŒ²ã€‚ãƒ‰ãƒ¼ãƒŠãƒ„ã®æ²¹åˆ†ã‚’ç‰›ä¹³ãŒæ´—ã„æµã™ã€ç§‘å­¦çš„ã«æœ€å¼·ã®çµ„ã¿åˆã‚ã›ã§ã™ã€‚" },
            { id: "coffee", name: "ãƒ–ãƒ©ãƒƒã‚¯ã‚³ãƒ¼ãƒ’ãƒ¼", score: 3.89, comment: "ç”˜ã¿ã¨è‹¦å‘³ã®ãƒãƒ©ãƒ³ã‚¹ãŒçµ¶å¦™ã€‚ç‹é“ã«ã—ã¦è‡³é«˜ã®ãƒšã‚¢ãƒªãƒ³ã‚°ã§ã™ã€‚" }
        ],
        "chou": [
            { id: "coffee", name: "ã‚³ãƒ¼ãƒ’ãƒ¼", score: 3.20, comment: "ã‚¯ãƒªãƒ¼ãƒ ã®æ¿ƒåšãªç”˜ã•ã‚’ã€ã‚³ãƒ¼ãƒ’ãƒ¼ã®è‹¦å‘³ãŒå¿ƒåœ°ã‚ˆãå¼•ãç· ã‚ã¾ã™ã€‚" },
            { id: "milk", name: "ç‰›ä¹³", score: 3.11, comment: "ç”Ÿåœ°ã¨ã‚¯ãƒªãƒ¼ãƒ ã®ä¹³æˆåˆ†ãŒç‰›ä¹³ã¨èª¿å’Œã—ã€ã¾ã‚ã‚„ã‹ã•ãŒå€å¢—ã—ã¾ã™ã€‚" }
        ],
        "cookie": [
            { id: "milk", name: "ç‰›ä¹³", score: 3.80, comment: "å£ã®ä¸­ã®æ°´åˆ†ã‚’è£œã„ã¤ã¤ã€ãƒã‚¿ãƒ¼ã®é¢¨å‘³ã‚’å¼•ãç«‹ã¦ã‚‹å®Œç’§ãªç›¸æ€§ã§ã™ã€‚" },
            { id: "tea", name: "ç´…èŒ¶", score: 3.20, comment: "å°éº¦ã®é¦™ã°ã—ã•ã¨ç´…èŒ¶ã®è¯ã‚„ã‹ãªé¦™ã‚ŠãŒå£ã®ä¸­ã§å„ªé›…ã«åºƒãŒã‚Šã¾ã™ã€‚" }
        ],
        "castella": [
            { id: "milk", name: "ç‰›ä¹³", score: 3.89, comment: "ã‚«ã‚¹ãƒ†ãƒ©ã®åµã®é¢¨å‘³ã«ç‰›ä¹³ãŒæµ¸é€ã—ã€ã—ã£ã¨ã‚Šã¨ã—ãŸä¸€ä½“æ„ŸãŒç”Ÿã¾ã‚Œã¾ã™ã€‚" },
            { id: "tea", name: "ç´…èŒ¶", score: 3.44, comment: "ã‚«ã‚¹ãƒ†ãƒ©ã®ã—ã£ã‹ã‚Šã—ãŸç”˜ã•ã‚’ã€ç´…èŒ¶ãŒä¸Šå“ã«ã¾ã¨ã‚ä¸Šã’ã¾ã™ã€‚" }
        ],
        "daifuku": [
            { id: "green_tea", name: "æ—¥æœ¬èŒ¶ï¼ˆç·‘èŒ¶ï¼‰", score: 3.00, comment: "å’Œè“å­ã«ã¯ã‚„ã¯ã‚Šæ—¥æœ¬èŒ¶ã€‚ã‚ã‚“ã“ã®ç”˜ã•ã‚’ç·‘èŒ¶ã®æ¸‹ã¿ãŒå¼•ãç«‹ã¦ã¾ã™ã€‚" },
            { id: "tea", name: "ç´…èŒ¶", score: 2.56, comment: "æ„å¤–ãªçµ„ã¿åˆã‚ã›ã§ã™ãŒã€ç´…èŒ¶ã®é¦™ã‚ŠãŒå’Œã®ç”˜ã¿ã‚’ãƒ¢ãƒ€ãƒ³ã«å¤‰ãˆã¦ãã‚Œã¾ã™ã€‚" }
        ],
        "choco": [
            { id: "coffee", name: "ã‚³ãƒ¼ãƒ’ãƒ¼", score: 3.50, comment: "ã‚«ã‚«ã‚ªã®è‹¦å‘³ã¨ã‚³ãƒ¼ãƒ’ãƒ¼ã®é¦™ã‚ŠãŒå…±é³´ã™ã‚‹ã€æº€è¶³æ„Ÿã®é«˜ã„ãƒšã‚¢ã§ã™ã€‚" },
            { id: "milk", name: "ç‰›ä¹³", score: 3.30, comment: "æ¿ƒåšãªãƒãƒ§ã‚³ã‚’ç‰›ä¹³ãŒã¾ã‚ã‚„ã‹ã«åŒ…ã¿è¾¼ã¿ã€å¾Œå‘³ã‚’ã‚¹ãƒƒã‚­ãƒªã•ã›ã¾ã™ã€‚" }
        ],
        "cheese": [
            { id: "tea", name: "ç´…èŒ¶", score: 3.40, comment: "ãƒãƒ¼ã‚ºã®é…¸å‘³ã¨ç´…èŒ¶ã®æ¸‹ã¿ã¯ã€ãŠäº’ã„ã‚’é«˜ã‚åˆã†ç›¸æ€§ã®è‰¯ã•ã§ã™ã€‚" },
            { id: "coffee", name: "ã‚³ãƒ¼ãƒ’ãƒ¼", score: 3.30, comment: "æ¿ƒåšãªãƒãƒ¼ã‚ºã®ã‚³ã‚¯ã«ã¯ã€æ·±ç…ã‚Šã®ã‚³ãƒ¼ãƒ’ãƒ¼ãŒã‚ˆãåˆã„ã¾ã™ã€‚" }
        ],
        "pudding": [
            { id: "coffee", name: "ã‚³ãƒ¼ãƒ’ãƒ¼", score: 3.10, comment: "ã‚«ãƒ©ãƒ¡ãƒ«ã®ã»ã‚è‹¦ã•ã¨ã‚³ãƒ¼ãƒ’ãƒ¼ã®è‹¦å‘³ã¯ã€å…„å¼Ÿã®ã‚ˆã†ãªç›¸æ€§ã®è‰¯ã•ã§ã™ã€‚" }
        ]
    };

    const surpriseDB = {
        "donut": { name: "ãƒªãƒ³ã‚´ã‚¸ãƒ¥ãƒ¼ã‚¹", surpriseScore: 2.11, text: "ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼ãªé…¸å‘³ãŒãƒ‰ãƒ¼ãƒŠãƒ„ã®æ²¹åˆ†ã‚’è»½ã‚„ã‹ã«ã—ã€å¾Œå‘³ã‚’çˆ½ã‚„ã‹ã«å¤‰ãˆã¦ãã‚Œã¾ã™ã€‚" },
        "chou": { name: "ç´…èŒ¶", surpriseScore: 2.55, text: "ã‚³ãƒ¼ãƒ’ãƒ¼ãŒå®šç•ªã§ã™ãŒã€ç´…èŒ¶ã®é¦™ã‚ŠãŒã‚¯ãƒªãƒ¼ãƒ ã®è¼ªéƒ­ã‚’ãã£ãã‚Šéš›ç«‹ãŸã›ã¾ã™ã€‚" },
        "cookie": { name: "ãƒªãƒ³ã‚´ã‚¸ãƒ¥ãƒ¼ã‚¹", surpriseScore: 2.55, text: "ãƒã‚¿ãƒ¼ã®é¦™ã‚Šã¨ãƒªãƒ³ã‚´ã®é…¸å‘³ãŒåˆã‚ã•ã‚‹ã¨ã€ã¾ã‚‹ã§ã‚¢ãƒƒãƒ—ãƒ«ãƒ‘ã‚¤ã®ã‚ˆã†ãªé¢¨å‘³ã«ï¼" },
        "castella": { name: "ã‚ªãƒ¬ãƒ³ã‚¸ã‚¸ãƒ¥ãƒ¼ã‚¹", surpriseScore: 2.60, text: "åµã®ã‚³ã‚¯ã«æŸ‘æ©˜ã®åˆºæ¿€ã€‚å®Ÿé¨“ã§ã‚‚ã€Œæƒ³åƒä»¥ä¸Šã«æ–°ã—ã„å‘³ã€ã¨è©•ä¾¡ã•ã‚ŒãŸçµ„ã¿åˆã‚ã›ã§ã™ã€‚" },
        "daifuku": { name: "ã‚ªãƒ¬ãƒ³ã‚¸ã‚¸ãƒ¥ãƒ¼ã‚¹", surpriseScore: 3.00, text: "ã€å®Ÿé¨“ã§æœ€å¤§ã®æ„å¤–æ€§ï¼ã€‘ã‚ã‚“ã“ã®ç”˜ã•ã¨ã‚ªãƒ¬ãƒ³ã‚¸ã®é…¸å‘³ã€‚æœªçŸ¥ã®åŒ–å­¦åå¿œã‚’æ¥½ã—ã‚ã¾ã™ã€‚" }
    };

    /* --- è³ªå•æ§‹æˆ (å‰å›ã¨åŒã˜10å•) --- */
    const questions = [
        { text: "Q1. ã‚³ãƒ¼ãƒ’ãƒ¼ã¯é£²ã‚ã¾ã™ã‹ï¼Ÿ", type: "filter", key: "canCoffee", options: [
            { text: "å¤§å¥½ãï¼ˆãƒ–ãƒ©ãƒƒã‚¯ã‚‚OKï¼‰", value: true },
            { text: "ãƒŸãƒ«ã‚¯ç­‰ãŒã‚ã‚Œã°é£²ã‚ã‚‹", value: true },
            { text: "è‹¦æ‰‹ï¼é£²ã‚ãªã„", value: false }
        ]},
        { text: "Q2. ç´…èŒ¶ã¯é£²ã‚ã¾ã™ã‹ï¼Ÿ", type: "filter", key: "canTea", options: [
            { text: "ã‚ˆãé£²ã‚€", value: true },
            { text: "ãŸã¾ã«é£²ã‚€", value: true },
            { text: "è‹¦æ‰‹ï¼é£²ã‚ãªã„", value: false }
        ]},
        { text: "Q3. ç‰›ä¹³ï¼ˆãƒŸãƒ«ã‚¯ï¼‰ãã®ã‚‚ã®ã¯å¥½ãã§ã™ã‹ï¼Ÿ", type: "filter", key: "canMilk", options: [
            { text: "å¥½ãï¼ˆãã®ã¾ã¾é£²ã‚ã‚‹ï¼‰", value: true },
            { text: "æ–™ç†ã‚„ã‚«ãƒ•ã‚§ã‚ªãƒ¬ãªã‚‰OK", value: true },
            { text: "è‹¦æ‰‹ï¼ãŠè…¹ãŒã”ã‚ã”ã‚ã™ã‚‹", value: false }
        ]},
        { text: "Q4. æ—¥æœ¬èŒ¶ï¼ˆç·‘èŒ¶ãªã©ï¼‰ã¯é£²ã¿ã¾ã™ã‹ï¼Ÿ", type: "filter", key: "canGreenTea", options: [
            { text: "ã‚ˆãé£²ã‚€", value: true },
            { text: "ã‚ã¾ã‚Šé£²ã¾ãªã„", value: true }
        ]},
        { text: "Q5. ç”˜ã„ã‚‚ã®ã‚’é£Ÿã¹ã‚‹æ™‚ã€é£²ã¿ç‰©ã«æ±‚ã‚ã‚‹å½¹å‰²ã¯ï¼Ÿ", type: "pref", options: [
            { text: "å£ã®ä¸­ã‚’ã•ã£ã±ã‚Šã•ã›ãŸã„", value: "refresh" },
            { text: "ç”˜ã•ã‚’å¼•ãç«‹ã¦ã¦ã»ã—ã„", value: "enhance" }
        ]},
        { text: "Q6. æ¿ƒåšãªã‚¹ã‚¤ãƒ¼ãƒ„ã¯å¥½ãã§ã™ã‹ï¼Ÿ", type: "pref", options: [
            { text: "å¤§å¥½ã", value: "rich" },
            { text: "ã©ã¡ã‚‰ã‹ã¨è¨€ãˆã°ã•ã£ã±ã‚Šæ´¾", value: "light" }
        ]},
        { text: "Q7. ã‚¯ãƒªãƒ¼ãƒ ç³»ã¯ã‚ˆãé£Ÿã¹ã¾ã™ã‹ï¼Ÿ", type: "pref", options: [
            { text: "ã‚ˆãé£Ÿã¹ã‚‹", value: "yes" },
            { text: "ã‚ã¾ã‚Šé£Ÿã¹ãªã„", value: "no" }
        ]},
        { text: "Q8. ãƒãƒ§ã‚³ç³»ã¯ã‚ˆãé¸ã³ã¾ã™ã‹ï¼Ÿ", type: "pref", options: [
            { text: "ã‚ˆãé¸ã¶", value: "yes" },
            { text: "ã‚ã¾ã‚Šé¸ã°ãªã„", value: "no" }
        ]},
        { text: "Q9. å’Œè“å­ã¯ã‚ˆãé£Ÿã¹ã¾ã™ã‹ï¼Ÿ", type: "pref", options: [
            { text: "ã‚ˆãé£Ÿã¹ã‚‹", value: "yes" },
            { text: "ã‚ã¾ã‚Šé£Ÿã¹ãªã„", value: "no" }
        ]},
        { text: "Q10. ä»Šã€é£Ÿã¹ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã‚¹ã‚¤ãƒ¼ãƒ„ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚", type: "target", options: [
            { text: "ãƒ‰ãƒ¼ãƒŠãƒ„", value: "donut" }, { text: "ã‚·ãƒ¥ãƒ¼ã‚¯ãƒªãƒ¼ãƒ ", value: "chou" },
            { text: "ã‚¯ãƒƒã‚­ãƒ¼", value: "cookie" }, { text: "ã‚«ã‚¹ãƒ†ãƒ©", value: "castella" },
            { text: "å¤§ç¦", value: "daifuku" }, { text: "ãƒãƒ§ã‚³ã‚±ãƒ¼ã‚­", value: "choco" },
            { text: "ãƒãƒ¼ã‚ºã‚±ãƒ¼ã‚­", value: "cheese" }, { text: "ãƒ—ãƒªãƒ³", value: "pudding" }
        ]}
    ];

    let currentIdx = 0;
    let prefs = { canCoffee: true, canTea: true, canMilk: true, canGreenTea: true };

    function startQuiz() {
        document.getElementById("start-screen").classList.add("hidden");
        document.getElementById("quiz-screen").classList.remove("hidden");
        showQuestion();
    }

    function showQuestion() {
        const q = questions[currentIdx];
        document.getElementById("question-text").innerText = q.text;
        const opts = document.getElementById("options-container");
        opts.innerHTML = "";
        document.getElementById("progress").style.width = `${(currentIdx / questions.length) * 100}%`;

        q.options.forEach(o => {
            const b = document.createElement("button");
            b.innerText = o.text;
            b.onclick = () => {
                if (q.type === "filter") prefs[q.key] = o.value;
                if (q.type === "target") {
                    prefs.target = o.value;
                    showResult();
                    return;
                }
                currentIdx++;
                showQuestion();
            };
            opts.appendChild(b);
        });
    }

    function showResult() {
        document.getElementById("quiz-screen").classList.add("hidden");
        document.getElementById("result-screen").classList.remove("hidden");

        const target = prefs.target;
        const candidates = pairingsDB[target];
        let best = null;

        // èª¿å’Œåº¦ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        for (let d of candidates) {
            if (d.id === "coffee" && !prefs.canCoffee) continue;
            if (d.id === "milk" && !prefs.canMilk) continue;
            if (d.id === "tea" && !prefs.canTea) continue;
            if (d.id === "green_tea" && !prefs.canGreenTea) continue;
            best = d;
            break;
        }
        if (!best) best = { name: "ãŠæ°´", score: "-", comment: "ç´ æã®å‘³ã‚’ãã®ã¾ã¾æ¥½ã—ã‚€ã®ãŒä¸€ç•ªã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚" };

        // èª¿å’Œåº¦è¡¨ç¤ºï¼ˆ4æ®µéšæ˜Ÿè©•ä¾¡ï¼‰
        document.getElementById("result-drink").innerText = best.name;
        if(best.score !== "-") {
            const s = parseFloat(best.score);
            document.getElementById("score-text").innerText = `èª¿å’Œåº¦: ${s.toFixed(2)} / 4.0`;
            document.getElementById("star-fill").style.width = `${(s / 4.0) * 100}%`;
        }
        document.getElementById("result-science-comment").innerHTML = `<strong>ã€åˆ†æã€‘</strong><br>${best.comment}`;

        // æ„å¤–æ€§è¡¨ç¤º
        const surprise = surpriseDB[target];
        const sArea = document.getElementById("surprise-area");
        if (surprise) {
            sArea.classList.remove("hidden");
            document.getElementById("surprise-drink").innerText = `Ã— ${surprise.name}`;
            document.getElementById("surprise-comment").innerText = `${surprise.text}ï¼ˆæ„å¤–æ€§ã‚¹ã‚³ã‚¢: ${surprise.surpriseScore}ï¼‰`;
        } else {
            sArea.classList.add("hidden");
        }
    }
</script>
</body>
</html>
